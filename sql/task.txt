Задание

Дано:
Таблица fer в схеме test с данными по обращениям в ФЭР.
Скрипт создания таблицы и ее наполнения данными в файле dump.sql. Кодировка файла ANSI, при необходимости изменить на нужную для выполнения скрипта в рабочей среде.
Таблица test.fer содержит количество обращений по субъектам РФ. Количество обращений по каждому виду обращения хранится в колонке с соответствующим именем.
Файл с результирующими данными - goal.csv, кодировка Window-1251, разделитель ";".

Требуется:
Проанализировать данные в таблице и в резльтрующем наборе. Написать скрипт, который можно было бы выполнить в psql и результатом работы которого должен стать файл, идентичный goal.csv.
Скрипт должен выполняться от имени пользователя, для которого таблица test.fer доступна только для чтения. Разрешается использовать временные таблицы и представления.
Результирующий набор данных должен содержать следующие колонки:
"Субъект РФ" - субъекты РФ по алфавиту или 'Российская Федерация' для данных по всей стране. Сначала идут данные по всей стране;
"Вид обращения" - виды обращений из соответствующих колонок, а также рассчитанное значение для всех, кроме ЕПГУ. Порядок сортировки представлен в файле goal.csv;
"Количество записей" - количество соответствующих обращений;
"%" - процентное соотношение количества записей по виду обращения к общему количеству записей для субъекта РФ и всей страны. Количество знаков после запятой - 2.

Проверка:
Подключение к БД, содержащей таблицу test.fer с исходными данными;
Запуск скрипта;
Сравнение полученного файла с goal.csv.
